window.twttr=function(a,b,c){var d,e=a.getElementsByTagName(b)[0];if(!a.getElementById(c))return a=a.createElement(b),a.id=c,a.src="https://platform.twitter.com/widgets.js",e.parentNode.insertBefore(a,e),window.twttr||(d={_e:[],ready:function(a){d._e.push(a)}})}(document,"script","twitter-wjs");var NS_Global=NS_Global||{};NS_Global.counterSlide=0;NS_Global.goTo=null;NS_Global.maxNews=16;NS_Global.video=$("#video");NS_Global.logo=$("#logo-fun");NS_Global.vignette13=$("#vignette13");
NS_Global.vignette14=$("#vignette14");NS_Global.vignette15=$("#vignette15");NS_Global.getRandom=function(a,b){var c=a[Math.floor(Math.random()*a.length)];return b&&b===c?NS_Global.getRandom(a,b):c};NS_Global.getRandomNum=function(a,b){var c=Math.floor(Math.random()*a);return b&&b===c?NS_Global.getRandomNum(a,b):c};
NS_Global.init=function(){NS_Global.counterSlide||(sessionStorage.clear(),NS_LiveInfo.hideLiveFrame(),NS_SocialCount.hideSocialFrame(),NS_GetNews.requester(),NS_LiveInfo.requester(),NS_SocialCount.getFbCount(),NS_SocialCount.getTwCount())};var NS_lobbyAnim=NS_lobbyAnim||{};NS_lobbyAnim.container=$("#container");NS_lobbyAnim.vignetteHolder=$("#vignette-holder");NS_lobbyAnim.vignettes=NS_lobbyAnim.vignetteHolder.find(".vignette");NS_lobbyAnim.vignettesImg=NS_lobbyAnim.vignetteHolder.find(".vignette img");
NS_lobbyAnim.containerMove="tolayer1 tolayer2 tolayer3 tolayer4 tolayer5 tolayer6".split(" ");NS_lobbyAnim.previousContainerClass="tolayer2";NS_lobbyAnim.containerClass=null;NS_lobbyAnim.counterSlide=0;NS_lobbyAnim.setAnimVignettes=function(){NS_lobbyAnim.vignetteHolder.toggleClass("animate")};
NS_lobbyAnim.setStartFrame=function(a,b){NS_lobbyAnim.containerClass=a;NS_lobbyAnim.previousContainerClass&&NS_lobbyAnim.container.removeClass(NS_lobbyAnim.previousContainerClass);NS_lobbyAnim.container.addClass(NS_lobbyAnim.containerClass);NS_lobbyAnim.previousContainerClass=NS_lobbyAnim.containerClass;setTimeout(function(){NS_GetNews.fillFrame(b)},3500)};NS_lobbyAnim.setEndFrame=function(){};
NS_lobbyAnim.setRestart=function(){setTimeout(function(){NS_LiveInfo.hideLiveFrame();NS_SocialCount.hideSocialFrame();NS_lobbyAnim.vignetteHolder.removeClass("animate")},7E3);setTimeout(NS_GetNews.fillFrame,7500)};var NS_GetNews=NS_GetNews||{};NS_GetNews.previousInfo=null;NS_GetNews.previousFrame=null;
NS_GetNews.requester=function(){$.ajax({type:"get",url:"http://services.funradio.fr/flux/articles.json?tags=funradio&nb="+NS_Global.maxNews,cache:!1,dataType:"jsonp",success:function(a,b,c){NS_GetNews.getData(a);$(window).trigger("newsReady")}})};
NS_GetNews.getData=function(a){$(a.items).each(function(a,c){$(c).each(function(c,e){var g=e.title,h=e.description.value,f="object"===typeof e.enclosures[c]?e.enclosures[c].url:"";NS_GetNews.setBgVignette(NS_lobbyAnim.vignettesImg,a,f);NS_GetNews.storeHtmlNews(g,h,f,a)})})};NS_GetNews.setBgVignette=function(a,b,c){a[b].src=c};NS_GetNews.storeHtmlNews=function(a,b,c,d){sessionStorage.setItem(d,'<div class="template-news"><h1><span>'+a+"</span></h1></div>")};
NS_GetNews.fillFrame=function(a){0===NS_Global.counterSlide?NS_Global.goTo="tolayer1":(NS_Global.goTo=NS_Global.getRandom(NS_lobbyAnim.containerMove,NS_lobbyAnim.previousContainerClass),setTimeout(function(){NS_GetNews.unfillFrame(a)},750));var b=NS_Global.goTo.split("to")[1],c=NS_Global.getRandomNum(NS_Global.maxNews,NS_GetNews.previousInfo),d=sessionStorage.getItem(c);$(d).appendTo($("."+b));NS_GetNews.previousInfo=c;$(window).trigger("setShowFrame",$("."+b))};
NS_GetNews.unfillFrame=function(a){a&&$(a).empty()};var NS_SocialCount=NS_SocialCount||{};NS_SocialCount.fbElem=$("#facebook");NS_SocialCount.twElem=$("#twitter");NS_SocialCount.fbCountElem=$("#fb-count");NS_SocialCount.twCountElem=$("#tw-count");
NS_SocialCount.getFbCount=function(){$.ajax({type:"get",url:"https://graph.facebook.com/?ids=funradio&callback=?",cache:!1,dataType:"jsonp",success:function(a,b,c){a=a.funradio.likes;b=a.toString();c=0;for(var d="",e=b.length-1;0<=e;e--)c++,d+=b[e],0===c%3&&b[e-1]&&(d+="."),a=d.split("").reverse().join("");NS_SocialCount.fbCountElem.text(a);a=NS_SocialCount.fbElem.html();NS_Global.vignette13.html(a);$(window).trigger("fbCountReady")},error:function(){}})};NS_SocialCount.showFbCount=function(){NS_SocialCount.fbElem.addClass("show")};
NS_SocialCount.getTwCount=function(){NS_SocialCount.twCountElem.text("736.345");var a=NS_SocialCount.twElem.html();NS_Global.vignette14.html(a);$(window).trigger("twCountReady")};NS_SocialCount.showTwCount=function(){NS_SocialCount.twElem.addClass("show")};NS_SocialCount.hideSocialFrame=function(){NS_SocialCount.fbElem.removeClass("show");NS_SocialCount.twElem.removeClass("show")};var NS_LiveInfo=NS_LiveInfo||{};NS_LiveInfo.container=$("#live");
NS_LiveInfo.requester=function(){$.ajax({type:"get",url:"http://www.funradio.fr/live/en-direct",cache:!1,dataType:"html",success:function(a,b,c){NS_LiveInfo.container.empty();a=a.replace(/<script.*?<\/script>/gi,"");a=a.match(/.*<body.*>([\s\S]*)<\/body>.*/)[1];NS_LiveInfo.container.append(a);NS_LiveInfo.container.append($('<span class="what">LIVE</span>'));NS_Global.vignette15.html(a);NS_Global.vignette15.append($('<span class="what">LIVE</span>'));$(window).trigger("liveInfoReady")},error:function(){NS_LiveInfo.container.empty()}})};
NS_LiveInfo.showLiveFrame=function(){NS_LiveInfo.container.addClass("show")};NS_LiveInfo.hideLiveFrame=function(){NS_LiveInfo.container.removeClass("show")};NS_Global.init();
$(window).on({newsReady:function(){NS_lobbyAnim.vignetteHolder.removeClass("animate");setTimeout(NS_GetNews.fillFrame,500)},setShowFrame:function(a,b){NS_Global.logo.toggleClass("animate");switch(NS_Global.counterSlide){case 5:$(".layer").empty();NS_lobbyAnim.setAnimVignettes();setTimeout(NS_SocialCount.showFbCount,500);setTimeout(function(){NS_LiveInfo.hideLiveFrame();NS_SocialCount.hideSocialFrame()},7E3);setTimeout(NS_lobbyAnim.setAnimVignettes,7250);setTimeout(NS_GetNews.fillFrame,7500);NS_Global.counterSlide++;
break;case 10:$(".layer").empty();NS_lobbyAnim.setAnimVignettes();setTimeout(NS_LiveInfo.showLiveFrame,500);setTimeout(function(){NS_LiveInfo.hideLiveFrame();NS_SocialCount.hideSocialFrame()},7E3);setTimeout(NS_lobbyAnim.setAnimVignettes,7250);setTimeout(NS_GetNews.fillFrame,7500);NS_Global.counterSlide++;break;case 15:$(".layer").empty();NS_lobbyAnim.setAnimVignettes();setTimeout(NS_SocialCount.showTwCount,500);setTimeout(function(){NS_LiveInfo.hideLiveFrame();NS_SocialCount.hideSocialFrame()},7E3);
setTimeout(NS_lobbyAnim.setAnimVignettes,7250);setTimeout(NS_GetNews.fillFrame,7500);NS_Global.counterSlide++;break;case 20:NS_Global.counterSlide=0;$(".layer").empty();NS_lobbyAnim.setAnimVignettes();setTimeout(NS_LiveInfo.showLiveFrame,500);setTimeout(function(){NS_LiveInfo.hideLiveFrame();NS_SocialCount.hideSocialFrame()},7E3);setTimeout(NS_lobbyAnim.setAnimVignettes,7250);setTimeout(NS_Global.init,7500);break;default:NS_lobbyAnim.setStartFrame(NS_Global.goTo,b),NS_Global.counterSlide++}}});